# Веб-сервис прогноза погоды для маршрута

Данная программа позволяет узнать погоду в городе 1 и городе 2

## Установка и запуск

1. Клонируйте репозиторий:

    ```bash
    git clone https://github.com/vlavrinov/project2
    ```

2. Установите необходимые библиотеки:

    ```bash
    pip install Flask requests geopy
    ```

3. Получите API ключ от OpenWeatherMap ([https://openweathermap.org/api](https://openweathermap.org/api)).

4. Вставьте ваш API ключ в файл `app.py` в переменную `API_KEY`.

5. Запустите приложение:

    ```bash
    python app.py
    ```

6. Откройте веб-браузер и перейдите по адресу [http://127.0.0.1:5000/](http://127.0.0.1:5000/).

## Функциональность

-   Пользователь вводит названия начального и конечного городов маршрута.
-   Сервис получает координаты городов с помощью библиотеки `geopy`.
-   Сервис запрашивает данные о погоде для каждого города с помощью OpenWeatherMap API.
-   Модель оценивает погодные условия на основе температуры, скорости ветра и количества осадков.
-   Пользователю отображается информация о погоде в каждом городе и общая оценка погодных условий.

## Обработка ошибок

В рамках проекта обрабатываются следующие ошибки:

-   **Ошибка получения координат города:** Если `geopy` не может определить координаты города, пользователю выводится сообщение об ошибке.
-   **Ошибка запроса к OpenWeatherMap API:** Если API недоступно, или произошла другая ошибка при запросе (например, превышен лимит запросов), пользователю выводится сообщение об ошибке.
-   **Ошибка обработки данных от API:** Если данные от API не содержат ожидаемых полей, пользователю выводится сообщение об ошибке.
-   **Ошибка ввода данных пользователем:** Если пользователь не ввел названия городов или ввел некорректные данные, ему выводится соответствующее сообщение об ошибке.

Все обработанные ошибки не приводят к падению приложения, а информируют пользователя о проблеме и предлагают ввести корректные данные или повторить попытку позже.

## Модель оценки погодных условий

Модель `check_bad_weather` оценивает погодные условия на основе следующих параметров:

-   Температура:
    -   Ниже 0°C или выше 35°C считается плохой погодой.
-   Скорость ветра:
    -   Скорость ветра выше 15 м/с (около 50 км/ч) считается плохой погодой.
-   Осадки (дождь или снег):
    -   Количество осадков более 0.5 мм/ч считается плохой погодой.
    -   Если есть данные о дожде и снеге, берется максимальное значение
-   Влажность:
    -   Влажность более 80% считается плохой погодой.

Если хотя бы один из параметров не соответствует норме, погода считается плохой.

## Используемые библиотеки

-   **Flask:** Для создания веб-приложения.
-   **Requests:** Для отправки HTTP-запросов к OpenWeatherMap API.
-   **Geopy:** Для получения координат городов по их названиям.
-   **JSON:** Для работы с данными в формате JSON.


## Тестирование

Для проверки работоспособности сервиса можно выполнить следующие тесты:

**Юзкейс 1: Корректный ввод данных.**

*   **Входные данные:**  "Москва" в поле "Начальный город", "Лондон" в поле "Конечный город".
*   **Ожидаемый результат:**  Страница с результатами, содержащая информацию о погоде в Москве и Санкт-Петербурге. Должны отображаться температура, скорость ветра, влажность и осадки (если есть) для обоих городов, а также оценка погодных условий ("Погода — супер" или "Ой-ой, погода плохая").

**Юзкейс 2: Некорректный ввод данных (несуществующий город).**

*   **Входные данные:** "Дщтвщтавощуафв" в поле "Начальный город", "Москва" в поле "Конечный город".
*   **Ожидаемый результат:** Сообщение об ошибке "Не удалось определить координаты одного или обоих городов. Пожалуйста, проверьте правильность написания." на главной странице.

